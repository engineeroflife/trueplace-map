<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>True Place Gifts Map</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

  <style>
    body {
      margin: 0;
      display: flex;
      height: 100vh;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }

    /* Sidebar */
    #sidebar {
      width: 290px;
      background: #ffffff;
      border-right: 1px solid #ddd;
      padding: 10px;
      overflow-y: auto;
    }

    .story-item {
      display: flex;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
      align-items: center;
    }

    .story-item:hover {
      background: #f2f6ff;
    }

    .story-item.active {
      background: #dff5e1;
      border-left: 5px solid #31a354;
    }

    .story-thumb {
      width: 48px;
      height: 48px;
      margin-right: 10px;
      border-radius: 6px;
      object-fit: cover;
    }

    #map {
      flex: 1;
      height: 100%;
      width: 100%;
    }

    /* Bea Bubble */
    #bea-message {
      position: absolute;
      bottom: 20px;
      left: 20px;
      display: flex;
      align-items: flex-end;
      z-index: 999;
    }

    #bea-img {
      width: 95px;
      margin-right: 10px;
    }

    #bea-text {
      background: white;
      padding: 12px 15px;
      border-radius: 10px;
      border: 1px solid #ccc;
      width: 220px;
      font-size: 14px;
      box-shadow: 0px 2px 6px rgba(0,0,0,0.15);
    }
  </style>

</head>
<body>

<!-- SIDEBAR -->
<div id="sidebar">
  <h2>True Place Stories</h2>

  <div class="story-item" data-id="iceage">
    <img class="story-thumb" src="windover.jpg">
    <div>
      <strong>From the Ice Age to the Space Age in Brevard County, FL</strong><br>
      Windover People · Titusville, FL
    </div>
  </div>

  <div class="story-item" data-id="flipcoin">
    <img class="story-thumb" src="FlipCoin.jpg">
    <div>
      <strong>The Coin That Flips the Super Bowl</strong><br>
      The Highland Mint · Melbourne, FL
    </div>
  </div>

  <div class="story-item" data-id="icecream">
    <img class="story-thumb" src="icecream.jpg">
    <div>
      <strong>The Ice Cream That Wanted to Go to Space</strong><br>
      Space Coast · Kennedy Space Center, FL
    </div>
  </div>

  <div class="story-item" data-id="tomthumb">
    <img class="story-thumb" src="TomThumb.jpg">
    <div>
      <strong>One of America’s First Global Celebrities — General Tom Thumb</strong><br>
      Middleborough, Massachusetts
    </div>
  </div>
</div>

<!-- MAP -->
<div id="map"></div>

<!-- BEA -->
<div id="bea-message">
  <img id="bea-img" src="Otter_BEa_nov25_1.webp">
  <div id="bea-text">
    Hi, I'm Bea! Tap any green lens on the map to explore a story from that place.
  </div>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
/* -----------------------------
   STORY DATA (4 locations)
------------------------------*/

const stories = [
  {
    id: "iceage",
    name: "From the Ice Age to the Space Age",
    coords: [28.613, -80.807] // Titusville
  },
  {
    id: "flipcoin",
    name: "The Coin That Flips the Super Bowl",
    coords: [28.083, -80.608] // Melbourne
  },
  {
    id: "icecream",
    name: "The Ice Cream That Wanted to Go to Space",
    coords: [28.573, -80.646] // Kennedy Space Center
  },
  {
    id: "tomthumb",
    name: "General Tom Thumb",
    coords: [41.893, -70.910] // Middleborough, MA
  }
];

/* -----------------------------
   MAP SETUP
------------------------------*/

var map = L.map('map').setView([28.3, -81.2], 7);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19
}).addTo(map);

/* -----------------------------
   MARKER ICONS
------------------------------*/

const iconSmall = 0.10;  // size in degrees (scale)
const iconBig   = 0.18;  // highlighted size

// Helper: creates bounding box around coordinate
function makeBounds(center, scale) {
  return [
    [center[0] + scale, center[1] - scale],
    [center[0] - scale, center[1] + scale]
  ];
}

let overlays = {}; // store each imageOverlay

stories.forEach(story => {
  let bounds = makeBounds(story.coords, iconSmall);

  let overlay = L.imageOverlay(
    "magnifying_gift_icon_green_transparent.png",
    bounds,
    { interactive: true }
  ).addTo(map);

  overlays[story.id] = overlay;

  overlay.on("click", () => {
    highlightStory(story.id);
  });
});

/* -----------------------------
   HIGHLIGHT FUNCTION
------------------------------*/

function highlightStory(id) {

  // 1) update sidebar selection
  document.querySelectorAll(".story-item").forEach(item => {
    item.classList.toggle("active", item.dataset.id === id);
  });

  // 2) enlarge the selected marker
  stories.forEach(story => {
    overlays[story.id].setBounds(
      makeBounds(story.coords, story.id === id ? iconBig : iconSmall)
    );
  });

  // 3) center map on selected marker
  const match = stories.find(s => s.id === id);
  map.setView(match.coords, map.getZoom());
}

/* -----------------------------
   CLICKING SIDEBAR SELECTS MARKER
------------------------------*/

document.querySelectorAll(".story-item").forEach(item => {
  item.addEventListener("click", () => {
    highlightStory(item.dataset.id);
  });
});
</script>

</body>
</html>
